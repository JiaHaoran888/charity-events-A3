<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Event Details - CityCare</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <link rel="stylesheet" href="/css/style.css">
</head>
<body ng-app="charityApp" ng-controller="EventCtrl as vm">
  <header class="site-header">
    <div class="container header-inner">
      <div class="brand">
        <img src="/assets/placeholder.jpg" alt="logo" class="logo">
        <div>
          <h1>CityCare Events</h1>
        </div>
      </div>
      <nav class="main-nav">
        <a href="/">Home</a>
        <a href="/search.html">Search Events</a>
      </nav>
    </div>
  </header>

  <main class="container event-page">
    <div id="event-detail" class="card" ng-if="event">
      <div class="event-media">
        <img ng-src="{{event.image_url || '/assets/placeholder.jpg'}}" alt="{{event.name}}">
        <div style="margin-top:12px" class="progress-wrap">
          <div style="display:flex;justify-content:space-between;font-size:13px;margin-bottom:8px">
            <span>Raised: ${{event.raised_amount | number:2}}</span><span>Goal: ${{event.goal_amount | number:2}}</span>
          </div>
          <div style="background:rgba(255,255,255,0.04);border-radius:8px;padding:6px">
            <div class="progress-bar" style="width:{{event.progress}}%"></div>
          </div>
        </div>
      </div>
      <div class="event-main">
        <h2>{{event.name}}</h2>
        <p class="muted">{{event.category}} · {{event.location}} · {{event.event_date | date:'medium'}}</p>
        <p style="margin-top:12px">{{event.description}}</p>
        <div class="details-grid">
          <div class="meta-item"><strong>Price</strong><div>{{event.price == 0 ? 'Free' : ('$' + (event.price|number:2))}}</div></div>
          <div class="meta-item"><strong>Contact</strong><div>{{event.contact_email}} · {{event.phone}}</div></div>
          <div class="meta-item"><strong>Address</strong><div>{{event.address || event.location}}</div></div>
          <div class="meta-item"><strong>Organization</strong><div>{{event.organization}}</div></div>
        </div>
        <div style="margin-top:14px">
          <button class="button" ng-click="goRegister()">Register</button>
        </div>
        <h3 style="margin-top:18px">Tickets</h3>
        <div ng-if="event.tickets.length > 0"><div class="meta-item" ng-repeat="t in event.tickets">{{t.type}} · ${{t.price | number:2}} · {{t.quantity}} available</div></div>
        <div ng-if="!event.tickets || event.tickets.length === 0" class="muted">No ticket information available.</div>
        <h3 style="margin-top:18px">Recent Registrations</h3>
        <div ng-if="event.registrations.length > 0"><div class="meta-item" ng-repeat="r in event.registrations"><strong>{{r.name}}</strong> · {{r.number_of_tickets}} ticket(s) · ${{r.amount_paid | number:2}} · {{r.registration_date | date:'medium'}}</div></div>
        <div ng-if="!event.registrations || event.registrations.length === 0" class="muted">No registrations yet.</div>
        <h3 style="margin-top:18px">Weather Forecast</h3>
        <div ng-if="weather">
          <div class="muted">Timezone: {{weather.timezone}}</div>
          <div style="margin-top:8px">
            <div class="meta-item" ng-repeat="(i, d) in weather.daily.time track by $index">
              <strong>{{weather.daily.time[$index] | date:'mediumDate'}}</strong>
              <div class="muted">Max: {{weather.daily.temperature_2m_max[$index]}}°C · Min: {{weather.daily.temperature_2m_min[$index]}}°C · Code: {{weather.daily.weather_code[$index]}}</div>
            </div>
          </div>
        </div>
        <div ng-if="!weather" class="muted">Weather information not available for this event.</div>
      </div>
    </div>
    <div class="card" ng-if="!event">
      <p>Loading event...</p>
    </div>
  </main>

  <footer class="site-footer">
    <div class="container">
      <p>© 2025 CityCare Foundation</p>
    </div>
  </footer>

    <script src="/js/angular.min.js"></script>
  <script src="/js/client-app.js"></script>
</body>
</html>
